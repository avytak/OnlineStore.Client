<div class="mobile-menu-overlay" [class.active]="true">
  <!-- Top: Gender switch and close -->
  <div class="mobile-menu-header">
    <div class="gender-switch">
      <button (click)="setGender('her')" [class.active]="activeGender === 'her'">She</button>
      <button (click)="setGender('him')" [class.active]="activeGender === 'him'">He</button>
    </div>
    <div class="user-action-panel">
      <button class="user-action-panel__basket"></button>
      <button class="user-action-panel__auth" (click)="openDialog()"></button>
      <button class="user-action-panel__close close-btn" (click)="closeMenu()"></button>
    </div>
  </div>

  <!-- Main view: List of categories -->
  <ng-container *ngIf="currentView === 'main'">
    <ul class="menu-category-list">
      <li *ngFor="let item of menuItems">
        <button class="category-item" (click)="openSubcategory(sanitizeLabel(item.label))">
          <span [innerHTML]="item.label"></span>
          <span class="category-item__arrow-icon"></span>
        </button>
      </li>
    </ul>
  </ng-container>

  <!-- Subcategory view -->
  <ng-container *ngIf="currentView === 'subcategory'">
    <div class="subcategory-header">
      <button class="back-btn" (click)="backToMain()"></button>
      <h3>{{ selectedCategory }}</h3>
    </div>

    <div class="subcategory-blocks">
      <div class="subcategory-list" *ngFor="let group of subcategories[selectedCategory!]">
        <ng-container
          *ngIf="activeGender === null
          || (!group.title.toLowerCase().includes('category'))
          || (activeGender === 'her' && group.title.toLowerCase().startsWith('women'))
          || (activeGender === 'him' && group.title.toLowerCase().startsWith('men'))"
        >
          <h5 class="subcategory-title">{{ group.title }}</h5>
          <ul class="subblock-list">
            <li *ngFor="let item of group.items">
              <a [routerLink]="item.route">{{ item.label }}</a>
            </li>
          </ul>
        </ng-container>
      </div>
    </div>
  </ng-container>
</div>
